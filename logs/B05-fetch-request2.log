>proxy temp/proxyProxy set up at localhost:19480
>source '/afs/andrew.cmu.edu/usr18/sarthak3/proxylab-m18-sarthakjain27/tests/B05-fetch-request2.cmd'># Test ability to handle combination of fetches and requests
>serve s1 s2 s3
Server s1 running at localhost:19481
Server s2 running at localhost:19482
Server s3 running at localhost:19483
>generate random-text1.txt 2K 
>generate random-text2.txt 4K 
>generate random-text3.txt 6K
>generate random-text4.txt 8K
>generate random-text5.txt 10K
>generate random-text6.txt 12K
>request r1 random-text1.txt s2
Client: Requesting '/random-text1.txt' from localhost:19482
Proxy stderr: host localhost uri http://localhost:19482 def_port 19482
Proxy stderr: Checking for presence of request in cache
Proxy stderr: GET /random-text1.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
>fetch f1 random-text1.txt s1
Proxy stderr: Connection: close
Client: Fetching '/random-text1.txt' from localhost:19481
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19482
Proxy stderr: Request-ID: r1
Proxy stderr: Response: Deferred
>request r2 random-text2.txt s3
Client: Requesting '/random-text2.txt' from localhost:19483
Proxy stderr: 
Proxy stderr: 
Proxy stderr: Calling check presence function
Proxy stderr: Returned from check presence with present node (nil)
Proxy stderr: Request not present in cache
Proxy stderr: writing the request headers to server GET /random-text1.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
>fetch f2 random-text2.txt s2
Client: Fetching '/random-text2.txt' from localhost:19482
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19482
Proxy stderr: Request-ID: r1
Proxy stderr: Response: Deferred
Proxy stderr: 
>request r3 random-text3.txt s1
Proxy stderr: 
Client: Requesting '/random-text3.txt' from localhost:19481
Proxy stderr: entering loop to read response from server
Proxy stderr: host localhost uri http://localhost:19481 def_port 19481
Proxy stderr: Checking for presence of request in cache
Proxy stderr: GET /random-text1.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
>fetch f3 random-text3.txt s3
Client: Fetching '/random-text3.txt' from localhost:19483
Proxy stderr: Host: localhost:19481
Proxy stderr: Request-ID: f1
>request r4 random-text4.txt s1
Proxy stderr: Response: Immediate
Client: Requesting '/random-text4.txt' from localhost:19481
Proxy stderr: 
Proxy stderr: 
Proxy stderr: Calling check presence function
Proxy stderr: Returned from check presence with present node (nil)
Proxy stderr: Request not present in cache
Proxy stderr: writing the request headers to server GET /random-text1.txt HTTP/1.0
>fetch f4 random-text4.txt s3
Client: Fetching '/random-text4.txt' from localhost:19483
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19481
>request r5 random-text5.txt s3
Proxy stderr: Request-ID: f1
Proxy stderr: Response: Immediate
Client: Requesting '/random-text5.txt' from localhost:19483
Proxy stderr: 
Proxy stderr: 
Proxy stderr: entering loop to read response from server
>fetch f5 random-text5.txt s2
Client: Fetching '/random-text5.txt' from localhost:19482
Proxy stderr: host localhost uri http://localhost:19483 def_port 19483
Proxy stderr: Checking for presence of request in cache
Proxy stderr: GET /random-text2.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
>request r6 random-text6.txt s2
Client: Requesting '/random-text6.txt' from localhost:19482
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19483
Proxy stderr: Request-ID: r2
Proxy stderr: Response: Deferred
Proxy stderr: 
>fetch f6 random-text6.txt s1
Proxy stderr: 
Client: Fetching '/random-text6.txt' from localhost:19481
Proxy stderr: Calling check presence function
Proxy stderr: Returned from check presence with present node (nil)
Proxy stderr: Request not present in cache
Proxy stderr: writing the request headers to server GET /random-text2.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
>delay 200
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19483
Proxy stderr: Request-ID: r2
Proxy stderr: Response: Deferred
Proxy stderr: 
Proxy stderr: 
Proxy stderr: entering loop to read response from server
Proxy stderr: While loop entered
Proxy stderr: nread 2108 and response_size 2108
Proxy stderr: New request inserted in cache uri_w/o_path http://localhost:19481 path /random-text1.txt port 19481 and size 2108
Proxy stderr: total request in cache 1
Proxy stderr: total cache size 2108
Proxy stderr: host localhost uri http://localhost:19482 def_port 19482
Proxy stderr: Checking for presence of request in cache
Proxy stderr: GET /random-text2.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19482
Proxy stderr: Request-ID: f2
Proxy stderr: Response: Immediate
Proxy stderr: 
Proxy stderr: 
Proxy stderr: Calling check presence function
Proxy stderr: Returned from check presence with present node (nil)
Proxy stderr: Request not present in cache
Proxy stderr: writing the request headers to server GET /random-text2.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19482
Proxy stderr: Request-ID: f2
Proxy stderr: Response: Immediate
Proxy stderr: 
Proxy stderr: 
Proxy stderr: entering loop to read response from server
Proxy stderr: While loop entered
Proxy stderr: nread 4108 and response_size 4108
Proxy stderr: New request inserted in cache uri_w/o_path http://localhost:19482 path /random-text2.txt port 19482 and size 4108
Proxy stderr: total request in cache 2
Proxy stderr: total cache size 6216
Proxy stderr: host localhost uri http://localhost:19481 def_port 19481
Proxy stderr: Checking for presence of request in cache
Proxy stderr: GET /random-text3.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19481
Proxy stderr: Request-ID: r3
Proxy stderr: Response: Deferred
Proxy stderr: 
Proxy stderr: 
Proxy stderr: Calling check presence function
Proxy stderr: Returned from check presence with present node (nil)
Proxy stderr: Request not present in cache
Proxy stderr: writing the request headers to server GET /random-text3.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19481
Proxy stderr: Request-ID: r3
Proxy stderr: Response: Deferred
Proxy stderr: 
Proxy stderr: 
Proxy stderr: entering loop to read response from server
Proxy stderr: host localhost uri http://localhost:19483 def_port 19483
Proxy stderr: Checking for presence of request in cache
Proxy stderr: GET /random-text3.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19483
Proxy stderr: Request-ID: f3
Proxy stderr: Response: Immediate
Proxy stderr: 
Proxy stderr: 
Proxy stderr: Calling check presence function
Proxy stderr: Returned from check presence with present node (nil)
Proxy stderr: Request not present in cache
Proxy stderr: writing the request headers to server GET /random-text3.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19483
Proxy stderr: Request-ID: f3
Proxy stderr: Response: Immediate
Proxy stderr: 
Proxy stderr: 
Proxy stderr: entering loop to read response from server
Proxy stderr: host localhost uri http://localhost:19481 def_port 19481
Proxy stderr: Checking for presence of request in cache
Proxy stderr: GET /random-text4.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19481
Proxy stderr: Request-ID: r4
Proxy stderr: Response: Deferred
Proxy stderr: 
Proxy stderr: 
Proxy stderr: Calling check presence function
Proxy stderr: Returned from check presence with present node (nil)
Proxy stderr: Request not present in cache
Proxy stderr: writing the request headers to server GET /random-text4.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19481
Proxy stderr: Request-ID: r4
Proxy stderr: Response: Deferred
Proxy stderr: 
Proxy stderr: 
Proxy stderr: entering loop to read response from server
Proxy stderr: host localhost uri http://localhost:19483 def_port 19483
Proxy stderr: Checking for presence of request in cache
Proxy stderr: GET /random-text4.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19483
Proxy stderr: Request-ID: f4
Proxy stderr: Response: Immediate
Proxy stderr: 
Proxy stderr: 
Proxy stderr: Calling check presence function
Proxy stderr: Returned from check presence with present node (nil)
Proxy stderr: Request not present in cache
Proxy stderr: writing the request headers to server GET /random-text4.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19483
Proxy stderr: Request-ID: f4
Proxy stderr: Response: Immediate
Proxy stderr: 
Proxy stderr: 
Proxy stderr: entering loop to read response from server
Proxy stderr: While loop entered
Proxy stderr: nread 6108 and response_size 6108
Proxy stderr: New request inserted in cache uri_w/o_path http://localhost:19483 path /random-text3.txt port 19483 and size 6108
Proxy stderr: total request in cache 3
Proxy stderr: total cache size 12324
Proxy stderr: host localhost uri http://localhost:19483 def_port 19483
Proxy stderr: Checking for presence of request in cache
Proxy stderr: GET /random-text5.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19483
Proxy stderr: Request-ID: r5
Proxy stderr: Response: Deferred
Proxy stderr: 
Proxy stderr: 
Proxy stderr: Calling check presence function
Proxy stderr: Returned from check presence with present node (nil)
Proxy stderr: Request not present in cache
Proxy stderr: writing the request headers to server GET /random-text5.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19483
Proxy stderr: Request-ID: r5
Proxy stderr: Response: Deferred
Proxy stderr: 
Proxy stderr: 
Proxy stderr: entering loop to read response from server
Proxy stderr: While loop entered
Proxy stderr: nread 8108 and response_size 8108
Proxy stderr: New request inserted in cache uri_w/o_path http://localhost:19483 path /random-text4.txt port 19483 and size 8108
Proxy stderr: total request in cache 4
Proxy stderr: total cache size 20432
Proxy stderr: host localhost uri http://localhost:19482 def_port 19482
Proxy stderr: Checking for presence of request in cache
Proxy stderr: GET /random-text5.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19482
Proxy stderr: Request-ID: f5
Proxy stderr: Response: Immediate
Proxy stderr: 
Proxy stderr: 
Proxy stderr: Calling check presence function
Proxy stderr: Returned from check presence with present node (nil)
Proxy stderr: Request not present in cache
Proxy stderr: writing the request headers to server GET /random-text5.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19482
Proxy stderr: Request-ID: f5
Proxy stderr: Response: Immediate
Proxy stderr: 
Proxy stderr: 
Proxy stderr: entering loop to read response from server
Proxy stderr: host localhost uri http://localhost:19482 def_port 19482
Proxy stderr: Checking for presence of request in cache
Proxy stderr: GET /random-text6.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19482
Proxy stderr: Request-ID: r6
Proxy stderr: Response: Deferred
Proxy stderr: 
Proxy stderr: 
Proxy stderr: Calling check presence function
Proxy stderr: Returned from check presence with present node (nil)
Proxy stderr: Request not present in cache
Proxy stderr: writing the request headers to server GET /random-text6.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19482
Proxy stderr: Request-ID: r6
Proxy stderr: Response: Deferred
Proxy stderr: 
Proxy stderr: 
Proxy stderr: entering loop to read response from server
Proxy stderr: While loop entered
Proxy stderr: nread 8192 and response_size 8192
Proxy stderr: While loop entered
Proxy stderr: nread 1917 and response_size 10109
Proxy stderr: New request inserted in cache uri_w/o_path http://localhost:19482 path /random-text5.txt port 19482 and size 10109
Proxy stderr: total request in cache 5
Proxy stderr: total cache size 30541
Proxy stderr: host localhost uri http://localhost:19481 def_port 19481
Proxy stderr: Checking for presence of request in cache
Proxy stderr: GET /random-text6.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19481
Proxy stderr: Request-ID: f6
Proxy stderr: Response: Immediate
Proxy stderr: 
Proxy stderr: 
Proxy stderr: Calling check presence function
Proxy stderr: Returned from check presence with present node (nil)
Proxy stderr: Request not present in cache
Proxy stderr: writing the request headers to server GET /random-text6.txt HTTP/1.0
Proxy stderr: User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20180601 Firefox/45.0
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: Host: localhost:19481
Proxy stderr: Request-ID: f6
Proxy stderr: Response: Immediate
Proxy stderr: 
Proxy stderr: 
Proxy stderr: entering loop to read response from server
Proxy stderr: While loop entered
Proxy stderr: nread 8192 and response_size 8192
Proxy stderr: While loop entered
Proxy stderr: nread 3917 and response_size 12109
Proxy stderr: New request inserted in cache uri_w/o_path http://localhost:19481 path /random-text6.txt port 19481 and size 12109
Proxy stderr: total request in cache 6
Proxy stderr: total cache size 42650
>check f1
Request f1 yielded expected status 'ok'
>check f2
Request f2 yielded expected status 'ok'
>check f3
Request f3 yielded expected status 'ok'
>check f4
Request f4 yielded expected status 'ok'
>check f5
Request f5 yielded expected status 'ok'
>check f6
Request f6 yielded expected status 'ok'
>respond r1 r6
Server responded to request r1 with status ok
Server responded to request r6 with status ok
>delay 100
Proxy stderr: While loop entered
Proxy stderr: nread 2108 and response_size 2108
Proxy stderr: New request inserted in cache uri_w/o_path http://localhost:19482 path /random-text1.txt port 19482 and size 2108
Proxy stderr: total request in cache 7
Proxy stderr: total cache size 44758
Proxy stderr: While loop entered
Proxy stderr: nread 8192 and response_size 8192
Proxy stderr: While loop entered
Proxy stderr: nread 3917 and response_size 12109
Proxy stderr: New request inserted in cache uri_w/o_path http://localhost:19482 path /random-text6.txt port 19482 and size 12109
Proxy stderr: total request in cache 8
Proxy stderr: total cache size 56867
>check r1
Request r1 yielded expected status 'ok'
>check r6
Request r6 yielded expected status 'ok'
>respond r2 r5
Server responded to request r2 with status ok
Server responded to request r5 with status ok
>delay 100
Proxy stderr: While loop entered
Proxy stderr: nread 4108 and response_size 4108
Proxy stderr: New request inserted in cache uri_w/o_path http://localhost:19483 path /random-text2.txt port 19483 and size 4108
Proxy stderr: total request in cache 9
Proxy stderr: total cache size 60975
Proxy stderr: While loop entered
Proxy stderr: nread 8192 and response_size 8192
Proxy stderr: While loop entered
Proxy stderr: nread 1917 and response_size 10109
Proxy stderr: New request inserted in cache uri_w/o_path http://localhost:19483 path /random-text5.txt port 19483 and size 10109
Proxy stderr: total request in cache 10
Proxy stderr: total cache size 71084
>check r2
Request r2 yielded expected status 'ok'
>check r5
Request r5 yielded expected status 'ok'
>respond r3 r4
Server responded to request r3 with status ok
Server responded to request r4 with status ok
>delay 100
Proxy stderr: While loop entered
Proxy stderr: nread 8108 and response_size 8108
Proxy stderr: While loop entered
Proxy stderr: New request inserted in cache uri_w/o_path http://localhost:19481 path /random-text4.txt port 19481 and size 8108
Proxy stderr: total request in cache 11
Proxy stderr: total cache size 79192
Proxy stderr: nread 6108 and response_size 6108
Proxy stderr: New request inserted in cache uri_w/o_path http://localhost:19481 path /random-text3.txt port 19481 and size 6108
Proxy stderr: total request in cache 12
Proxy stderr: total cache size 85300
>check r3
Request r3 yielded expected status 'ok'
>check r4
Request r4 yielded expected status 'ok'
>quit
ALL TESTS PASSED
